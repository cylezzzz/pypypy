<!DOCTYPE html><html lang="de"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Create – Andio Media Studio</title><link rel="stylesheet" href="assets/styles.css"/></head><body>
<header class="header">
  <div class="brand"><span class="dot" style="width:10px;height:10px;border-radius:999px;background:linear-gradient(135deg,#6aa3ff,#b884ff)"></span> <span>Create – Andio Media Studio</span></div>
  <nav>
    <a href="index.html" >Dashboard</a>
    <a href="create.html" class="active">Create</a>
    <a href="video.html" >Video Lab</a>
    <a href="talking.html" >Talking</a>
    <a href="wardrobe.html" >Wardrobe</a>
    <a href="catalog.html" >Store</a>
    <a href="gallery.html" >Galerie</a>
  </nav>
</header>
<div class="wrap">
<div class="grid">
  <div class="card" style="grid-column: span 8">
    <h2>Bild-Studio</h2>
    <div id="progressHost"></div>
    <label>Prompt</label>
    <textarea id="prompt" rows="3" class="input"></textarea>
    <label style="margin-top:8px">Negative Prompt</label>
    <textarea id="neg" rows="2" class="input"></textarea>
    <div class="toolbar" style="margin-top:8px">
      <button class="btn" onclick="run('txt2img')">Text→Bild</button>
      <button class="btn" onclick="run('img2img')">Bild→Bild</button>
      <button class="btn" onclick="run('inpaint')">Inpainting</button>
      <button class="btn" onclick="run('pose_transfer')">Pose-Transfer</button>
    </div>
    <div class="card" style="margin-top:12px">
      <h3>Assets</h3>
      <div class="toolbar">
        <input type="file" id="img" accept="image/*" class="input" />
        <input type="file" id="mask" accept="image/*" class="input" />
        <input type="file" id="pose_ref" accept="image/*" class="input" />
        <button class="btn secondary" onclick="autoMask()">Auto-Maske</button>
      </div>
      <div id="files" style="margin-top:8px"></div>
    </div>
  </div>
  <div class="card" style="grid-column: span 4">
    <h2>Steuerung</h2>
    <div class="grid" style="grid-template-columns:repeat(2,1fr)">
      <div><label>Breite</label><input id="width" class="input" type="number" value="896"/></div>
      <div><label>Höhe</label><input id="height" class="input" type="number" value="1152"/></div>
      <div><label>Guidance</label><input id="guidance" class="input" type="number" step="0.1" value="6.0"/></div>
      <div><label>Steps</label><input id="steps" class="input" type="number" value="28"/></div>
      <div><label>Seed</label><input id="seed" class="input" type="number" placeholder=""/></div>
      <div><label>Strength</label><input id="strength" class="input" type="number" step="0.01" value="0.65"/></div>
    </div>
    <h2 style="margin-top:16px">Modell</h2>
    <div class="search">
      <input id="modelFilter" class="input" placeholder="Filter…"/>
      <select id="model" class="input"></select>
    </div>
  </div>
</div>
<script>
const PM = new ProgressManager(document); PM.mount();
let CATALOG=[];
(async ()=>{ const data=await API.models(); CATALOG=data.models||[]; fillModels(); })();
function fillModels(){ const sel=document.getElementById('model'); sel.innerHTML=''; const f=(document.getElementById('modelFilter').value||'').toLowerCase(); (CATALOG||[]).filter(m=>!f || m.name.toLowerCase().includes(f) || (m.tags||[]).join(',').toLowerCase().includes(f)).forEach(m=>{ const opt=document.createElement('option'); opt.value=m.name; opt.textContent=m.name; sel.appendChild(opt); }); }
document.getElementById('modelFilter').addEventListener('input', fillModels);
async function uploadSingle(id){ const i=document.getElementById(id); if(!i.files || !i.files[0]) return null; const res=await API.upload(i.files[0],'workspace'); const files=document.getElementById('files'); const a=document.createElement('a'); a.href='player.html?src='+encodeURIComponent(res.path); a.textContent=res.path; files.appendChild(a); files.appendChild(document.createElement('br')); return res.path; }
async function autoMask(){ const imgPath=await uploadSingle('img'); if(!imgPath){ return toast('Bitte ein Bild hochladen'); } const fd=new FormData(); fd.append('image_path', imgPath); const res=await fetch('/api/auto_mask',{method:'POST',body:fd}).then(r=>r.json()); if(res.ok){ toast('Maske erstellt: '+res.mask_path); } else { toast('Auto-Maske fehlgeschlagen'); } }
async function run(task){
  const prompt=document.getElementById('prompt').value.trim();
  const negative=(document.getElementById('neg').value||'').trim();
  const w=parseInt(document.getElementById('width').value||'896'); const h=parseInt(document.getElementById('height').value||'1152');
  const steps=parseInt(document.getElementById('steps').value||'28'); const guidance=parseFloat(document.getElementById('guidance').value||'6.0');
  const seed=(document.getElementById('seed').value||'')?parseInt(document.getElementById('seed').value):null; const strength=parseFloat(document.getElementById('strength').value||'0.65');
  const model=document.getElementById('model').value||null;
  let inputs={width:w,height:h,steps,guidance,seed};
  if(task==='img2img' || task==='inpaint'){ const imgPath=await uploadSingle('img'); if(!imgPath){ return toast('Bitte Bild hochladen'); } inputs.image_path=imgPath; }
  if(task==='inpaint'){ const maskPath=await uploadSingle('mask'); if(!maskPath){ return toast('Bitte Maske hochladen'); } inputs.mask_path=maskPath; inputs.strength=strength; }
  const res=await API.job({task, prompt, negative, quality:'BALANCED', model_preference:model, inputs});
  if(res.ok){ PM.connect(res.job.id); toast('Job gestartet: '+res.job.id); } else { toast('Fehler: Job konnte nicht gestartet werden'); }
}
</script>
</div><script src="assets/app.js"></script><div class="toast"></div></body></html>